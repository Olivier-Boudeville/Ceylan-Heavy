# Ad-hoc makefile for Orge's prerequisites.

# Actual source file is:
# ceylan/Ceylan/src/code/scripts/erlang/top-Ceylan-Erlang-GNUmakefile
#
# To be copied as Ceylan-Erlang/GNUmakefile.

.PHONY: all clean co ci up st



USER_NAME := wondersye


MODULES_DIRS = common wooper traces tools

VCS_ROOT = "ssh://$(USER_NAME)@git.code.sf.net/p/ceylan/"


CORE_COUNT := `grep -c processor /proc/cpuinfo`



all:
	@for m in $(MODULES_DIRS); do ( cd $$m ; $(MAKE) -j $(CORE_COUNT) all-recurse ) ; done


clean:
	@for m in $(MODULES_DIRS); do ( cd $$m ; $(MAKE) clean ) ; done


# Useful if having version mismatches:
co:
	@for m in $(MODULES_DIRS); do git clone $(VCS_ROOT)/$$m $$m ; done


ci:
	@for m in $(MODULES_DIRS); do ( cd $$m ; git ci ) ; done


up:
	@for m in $(MODULES_DIRS); do ( cd $$m ; git pull ) ; done


st:
	@for m in $(MODULES_DIRS); do ( cd $$m ; git status ) ; done
